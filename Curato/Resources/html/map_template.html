<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <style>
        html, body, #map {
            height: 100%;
            margin: 0;
            padding: 0;
        }

        .marker-label {
            background: #FFB31A;
            color: white;
            font-size: 12px;
            font-weight: bold;
            border-radius: 50%;
            text-align: center;
            width: 20px;
            height: 20px;
            line-height: 20px;
            transform: translate(-50%, -100%);
        }
    </style>
    <script src="https://dapi.kakao.com/v2/maps/sdk.js?appkey={API_KEY}&autoload=false"></script>
</head>
<body>
    <div id="map"></div>
    <script>
        kakao.maps.load(function () {
            var container = document.getElementById('map');
            var options = {
                center: new kakao.maps.LatLng({LAT}, {LNG}),
                level: 3
            };
            var map = new kakao.maps.Map(container, options);

            var locations = {COORD_ARRAY};  // Injected array
            var path = [];

            var sharedInfoWindow = new kakao.maps.InfoWindow();

            locations.forEach(function(place, index) {
                var marker = new kakao.maps.Marker({
                    position: new kakao.maps.LatLng(place.lat, place.lng),
                    map: map,
                    title: place.name
                });

                var label = new kakao.maps.CustomOverlay({
                    position: marker.getPosition(),
                    content: '<div class="marker-label">' + place.index + '</div>',
                    yAnchor: 1
                });
                label.setMap(map);

                var infowindow = new kakao.maps.InfoWindow({
                    content: '<div style="padding:5px;font-size:14px;">' + place.name + '</div>'
                });

                kakao.maps.event.addListener(marker, 'click', function () {
                    sharedInfoWindow.setContent('<div style="padding:5px;font-size:14px;">' + place.name + '</div>');
                    sharedInfoWindow.open(map, marker);
                });

                path.push(marker.getPosition());
            });

            kakao.maps.event.addListener(map, 'click', function () {
                sharedInfoWindow.close();
            });


            // Draw line connecting the places
            var polyline = new kakao.maps.Polyline({
                path: path,
                strokeWeight: 5,
                strokeColor: '#FF6F61',
                strokeOpacity: 0.7,
                strokeStyle: 'solid'
            });
            polyline.setMap(map);
        });
    </script>
</body>
</html>